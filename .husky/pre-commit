echo "ğŸš€ Running Pre-Commit Hook..."

# Get the current branch name
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)

# Prevent commits directly to the "main" branch
if [ "$CURRENT_BRANCH" = "main" ]; then
  echo "ğŸš¨ You are on the 'main' branch. Please commit to a feature branch instead."
  exit 1
fi

# Run the build process to ensure no errors
echo "ğŸ”¨ Building the project..."
npm run build || { echo "âŒ Build failed. Commit aborted."; exit 1; }

# Run lint-staged for formatting and linting staged files
echo "âœ… Build successful. Running Prettier & ESLint..."
npx lint-staged

# Stage all changes after lint-staged (to include Prettier & ESLint fixes)
echo "ğŸ“Œ Staging changes after formatting..."
git add -A .